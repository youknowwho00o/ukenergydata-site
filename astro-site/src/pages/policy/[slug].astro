---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";
import { marked } from "marked"; // âœ… ç”¨äºè§£æ Markdown æ­£æ–‡

// âš™ï¸ ç”Ÿæˆé™æ€è·¯å¾„
export async function getStaticPaths() {
  const policies = await getCollection("policy");
  return policies.map((policy) => ({
    params: { slug: policy.slug },
    props: { policy },
  }));
}

// ğŸ§© è·å–æ–‡ç« å†…å®¹ä¸å…ƒæ•°æ®
const { policy } = Astro.props;
const { data, body } = policy;

// âœ… å°† Markdown è½¬æ¢ä¸º HTML
const htmlContent = marked.parse(body);
---

<Layout title={data.title}>
  <article
    class="prose prose-invert max-w-4xl mx-auto px-6 py-12 bg-[#0B1625]/50 rounded-2xl shadow-lg border border-[#1E3A5F]/60"
  >
    <!-- ğŸ•’ æ—¥æœŸï¼Œä»…æ­¤ä¸€å¤„æ˜¾ç¤º -->
    <p class="text-sm italic text-gray-400 mb-6">{data.date}</p>

    <!-- ğŸ“œ æ­£æ–‡å†…å®¹ -->
    <div
      class="prose prose-invert prose-headings:text-blue-300 prose-a:text-blue-400 prose-strong:text-white prose-p:text-gray-200 prose-li:marker:text-blue-400 leading-relaxed text-[1.05rem]"
      set:html={htmlContent}
    ></div>

    <!-- ğŸ§­ é¡µè„š -->
    <footer
      class="mt-10 pt-6 border-t border-[#1E3A5F]/40 text-sm text-gray-500 text-center"
    >
      Source: UK Energy Data AI Policy Generator â€¢ Auto-updated
    </footer>
  </article>
</Layout>
